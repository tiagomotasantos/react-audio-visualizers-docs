<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>React-admin - Architecture</title>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta name="description" content="" />
        <meta name="HandheldFriendly" content="true" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <link
            rel="canonical"
            href="/Architecture.html"
        />
        <link
            rel="stylesheet"
            href="/css/materialize.min.css"
        />
        <link
            rel="stylesheet"
            href="/css/style-v11.css"
        />
        <link rel="stylesheet" href="/css/syntax.css" />
        <link rel="stylesheet" href="/css/prism.css" />
        <link rel="stylesheet" href="/css/tocbot.css" />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@docsearch/css@1.0.0-alpha.28"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.css"
        />
        <link
            rel="stylesheet"
            href="/css/docsearch.css"
        />
    </head>

    <body>
        <header>
            <div id="banner" style="background-color: #4b3165; padding: 3px;text-align:center;color: white;display:none">
                We're hiring! 
                <a href="https://marmelab.com/en/jobs/developer" style="color:white;text-decoration:underline">Join the react-admin team today</a> 
                and get paid to work on the library you love. Remote friendly.
                <span style="position:absolute;right:10px"><a href="javascript:hideBanner()" style="color:white;">X</a></span>
            </div>
            <script>
                function hideBanner() {
                    document.getElementById('banner').style.display = 'none';
                    window.localStorage.setItem('hideBannerDate', Date.now());
                }
                const hideBannerDate = parseInt(window.localStorage.getItem('hideBannerDate'), 10);
                if (!hideBannerDate || (Date.now() - hideBannerDate) > 14 * 24 * 60 * 60 * 1000) { // two weeks
                    document.getElementById('banner').style.display = 'block';
                }
            </script>
            <nav>
                <a href="#" data-target="slide-out" class="sidenav-trigger"
                    ><i class="material-icons">menu</i></a
                >
                <div
                    class="nav-wrapper"
                    style="
                        background: linear-gradient(
                            145deg,
                            #027be3 11%,
                            #1a237e 75%
                        );
                    "
                >
                    <div class="left">
                        <div id="docsearch" class="center"></div>
                    </div>
                    <ul id="nav-mobile" class="right hide-on-med-and-down">
                        <li class="active">
                            <a
                                href="https://marmelab.com/react-admin/Readme.html"
                                >Documentation</a
                            >
                        </li>
                        <li>
                            <a href="https://marmelab.com/react-admin/Demos.html"
                                >Demos</a
                            >
                        </li>
                        <li>
                            <a href="https://marmelab.com/en/blog/#react-admin"
                                >Blog</a
                            >
                        </li>
                        <li>
                            <a
                                href="https://marmelab.com/ra-enterprise/"
                                style="color: #f0c070"
                                >Enterprise Edition</a
                            >
                        </li>
                        <li>
                            <a href="https://github.com/marmelab/react-admin">
                                <svg
                                    viewBox="0 0 256 250"
                                    preserveAspectRatio="xMidYMid"
                                    style="
                                        height: 20px;
                                        vertical-align: middle;
                                        margin-right: 5px;
                                        fill: #ffffff;
                                    "
                                >
                                    <path
                                        d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403z"
                                    ></path>
                                </svg>
                                GitHub
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <ul id="slide-out" class="sidenav sidenav-fixed">
                <li class="logo">
                    <a href=""
                        ><img src="/assets/logo_white.png"
                    /></a>
                </li>
                <li class="version">
<a class="dropdown-trigger" href="#" data-target="versions">
    
    
    
    <svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 10l5 5 5-5z"></path>
        <path d="M0 0h24v24H0z" fill="none"></path>
    </svg>
</a>
<ul id="versions" class="dropdown-content">
    
</ul>
</li>
                <li ><a href="./GettingStarted.html">Getting Started</a></li>

<ul><div>Core</div>
  <li ><a href="./AudioVisualizer.html"><code>&lt;AudioVisualizer&gt;</code></a></li>
  <li ><a href="./AudioVisualizerUtils.html"><code>AudioVisualizerUtils</code></a></li>
  <li ><a href="./AudioVisualizerHooks.html"><code>AudioVisualizerHooks</code></a></li>
  <li ><a href="./Types.html">Types</a></li>
</ul>

<ul><div>Visualizers</div>
  <li ><a href="./SpectrumVisualizer.html"><code>&lt;SpectrumVisualizer&gt;</code></a></li>
  <li ><a href="./WaveformVisualizer.html"><code>&lt;WaveformVisualizer&gt;</code></a></li>
</ul>

<li  class="active" ><a href="./Architecture.html">Architecture</a></li>

            </ul>
        </header>

        <main>
            <div class="container">
                <div class="row">
                    <div
                        class="col s12 m8 offset-m1 xl7 offset-xl1 markdown-section DocSearch-content toc-content"
                    >
                        <h1 id="architecture">Architecture</h1>

<p>React-admin relies on a few design decisions that structure its codebase.</p>

<h2 id="model-view-controller">Model View Controller</h2>

<p>React-admin loosely implements <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">the Model-View-Controller pattern</a> for page components, and for complex components.</p>

<ul>
  <li>The Controller logic is provided by React hooks (e.g. <code class="language-plaintext highlighter-rouge">useListController</code>).</li>
  <li>The view logic by React components (e.g. <code class="language-plaintext highlighter-rouge">&lt;List&gt;</code>).</li>
  <li>The model logic is up to the developer, and react-admin only forces the interface that the model must expose via its Providers.</li>
</ul>

<h2 id="providers">Providers</h2>

<p>React-admin apps must integrate with existing backends, but there isn’t any standard way to do so (or rather, there are too many standards to do so, e.g. REST, GraphQL, SOAP for data access).</p>

<p>So react-admin uses the Adapter pattern to let developers plug their backends in. The idea is that react-admin defines an interface to interacts with data, authentication, and internationalization. You must provide an object that satisfies this interface. How that translates to actual HTTP calls is up to you.</p>

<p>For instance, the interface for reading, editing and deleting data is the <code class="language-plaintext highlighter-rouge">dataProvider</code> interface:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">dataProvider</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">getList</span><span class="p">:</span>    <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">getOne</span><span class="p">:</span>     <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">getMany</span><span class="p">:</span>    <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">getManyReference</span><span class="p">:</span> <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">create</span><span class="p">:</span>     <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">update</span><span class="p">:</span>     <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">updateMany</span><span class="p">:</span> <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">delete</span><span class="p">:</span>     <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
    <span class="na">deleteMany</span><span class="p">:</span> <span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Other providers are <code class="language-plaintext highlighter-rouge">authProvider</code>, for managing authorization and permissions, and <code class="language-plaintext highlighter-rouge">i18nProvider</code>, for managing translations and localization.</p>

<h2 id="component-composition">Component Composition</h2>

<p>We try to avoid as much as possible having components accepting a huge number of props (we call these “God Components”). Instead, we use composition: complex components accept subcomponents (either via children or via specific props) that handle a large share of the logic.</p>

<p>For instance, you cannot pass a list of actions to the <code class="language-plaintext highlighter-rouge">&lt;Edit&gt;</code> view, but you can pass an <code class="language-plaintext highlighter-rouge">actions</code> component:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Button</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@material-ui/core/Button</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">TopToolbar</span><span class="p">,</span> <span class="nx">ShowButton</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">PostEditActions</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">basePath</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">resource</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">TopToolbar</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">ShowButton</span> <span class="na">basePath</span><span class="p">=</span><span class="si">{</span><span class="nx">basePath</span><span class="si">}</span> <span class="na">record</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span><span class="si">}</span> <span class="p">/&gt;</span>
        <span class="si">{</span><span class="cm">/* Add your custom actions */</span><span class="si">}</span>
        <span class="p">&lt;</span><span class="nc">Button</span> <span class="na">color</span><span class="p">=</span><span class="s">"primary"</span> <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">customAction</span><span class="si">}</span><span class="p">&gt;</span>Custom Action<span class="p">&lt;/</span><span class="nc">Button</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">TopToolbar</span><span class="p">&gt;</span>
<span class="p">);</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">PostEdit</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Edit</span> <span class="na">actions</span><span class="p">=</span><span class="si">{</span><span class="p">&lt;</span><span class="nc">PostEditActions</span> <span class="p">/&gt;</span><span class="si">}</span> <span class="si">{</span><span class="p">...</span><span class="nx">props</span><span class="si">}</span><span class="p">&gt;</span>
        ...
    <span class="p">&lt;/</span><span class="nc">Edit</span><span class="p">&gt;</span>
<span class="p">);</span>
</code></pre></div></div>

<p>This allows overriding only part of the logic of a component by composing it with another component.</p>

<p>Many react-admin components can be overridden by passing custom components as children or via props.</p>

<p>The drawback is that react-admin sometimes forces you to override several components just to enable one feature. For instance, to override the Menu, you must pass it to a custom <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code>, and pass the custom <code class="language-plaintext highlighter-rouge">&lt;Layout&gt;</code> to <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// in src/Layout.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Layout</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Menu</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Menu</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">Layout</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">&lt;</span><span class="nc">Layout</span> <span class="si">{</span><span class="p">...</span><span class="nx">props</span><span class="si">}</span> <span class="na">menu</span><span class="p">=</span><span class="si">{</span><span class="nx">Menu</span><span class="si">}</span> <span class="p">/&gt;;</span>

<span class="c1">// in src/App.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Layout</span> <span class="p">}</span>  <span class="k">from</span> <span class="dl">'</span><span class="s1">./Layout</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Admin</span> <span class="na">layout</span><span class="p">=</span><span class="si">{</span><span class="nx">Layout</span><span class="si">}</span> <span class="na">dataProvider</span><span class="p">=</span><span class="si">{</span><span class="nx">simpleRestProvider</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://path.to.my.api</span><span class="dl">'</span><span class="p">)</span><span class="si">}</span><span class="p">&gt;</span>
        // ...
    <span class="p">&lt;/</span><span class="nc">Admin</span><span class="p">&gt;</span>
<span class="p">);</span>
</code></pre></div></div>

<p>We consider that the drawback is acceptable, especially considering the benefits offered by composition.</p>

<h2 id="user-experience-is-king">User Experience Is King</h2>

<p>React-admin has two sets of users:</p>

<ul>
  <li>End users, who use the react-admin app in their browser</li>
  <li>Developers, who build the react-admin app in their IDE</li>
</ul>

<p>For each feature, we design the User Experience (UX) and the Developer Experience (DX) carefully.</p>

<p>For the visual part, react-admin builds upon material-ui, which is the implementation of the Material Design System. It’s a great help to build usable, consistent user interfaces, but it’s not enough.</p>

<p>We spend a great deal of time refining the UI to make it as intuitive as possible. We pay attention to small alignment glitches, screen flashes, and color inconsistencies. We iterate with every customer feedback, to remove visual and animation problems that occur in real-life applications.</p>

<p>With theme customization, any developer can make an ugly react-admin app, but we do our best to make it not too shabby by default. React-admin produces a user interface that is voluntarily bland by default because we want to emphasize content rather than chrome.</p>

<p><img src="./img/sort-button.gif" alt="Sort Button" /></p>

<h2 id="context-pull-dont-push">Context: Pull, Don’t Push</h2>

<p>React-admin makes heavy use of React contexts. Whenever a component creates data or callbacks, it makes them available to descendants via a context.</p>

<p>So when a component needs to access data or callbacks defined higher in the render tree, it can always find the context to get it.</p>

<p>For instance, to write a custom Field type for your Datagrid, use the <code class="language-plaintext highlighter-rouge">useRecordContext</code> hook to grab the current record value:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">PropTypes</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">prop-types</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useRecordContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">TextField</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">source</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">record</span> <span class="o">=</span> <span class="nx">useRecordContext</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">record</span><span class="p">[</span><span class="nx">source</span><span class="p">]</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="nx">TextField</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">label</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span>
    <span class="na">record</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span>
    <span class="na">source</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">TextField</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Tip</strong>: Previous versions of react-admin used the “push, don’t pull” approach instead. Some components haven’t migrated to the Context architecture yet, or their documentation hasn’t been updated yet. That explains why some components expect a certain list of props to be pushed by their parent, like for instance <code class="language-plaintext highlighter-rouge">&lt;ShowButton&gt;</code>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ShowButton</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">CommentShowButton</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">record</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ShowButton</span> <span class="na">basePath</span><span class="p">=</span><span class="s">"/comments"</span> <span class="na">label</span><span class="p">=</span><span class="s">"Show comment"</span> <span class="na">record</span><span class="p">=</span><span class="si">{</span><span class="nx">record</span><span class="si">}</span> <span class="p">/&gt;</span>
<span class="p">);</span>
</code></pre></div></div>

<p>This works, but the idiomatic way to do so is by using the appropriate context:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ShowButton</span><span class="p">,</span> <span class="nx">userecordContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">CommentShowButton</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">record</span> <span class="o">=</span> <span class="nx">useRecordContext</span><span class="p">();</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">ShowButton</span> <span class="na">basePath</span><span class="p">=</span><span class="s">"/comments"</span> <span class="na">label</span><span class="p">=</span><span class="s">"Show comment"</span> <span class="na">record</span><span class="p">=</span><span class="si">{</span><span class="nx">record</span><span class="si">}</span> <span class="p">/&gt;</span>
    <span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="hooks">Hooks</h2>

<p>React-admin contexts aren’t exposed directly. Instead, react-admin exposes hooks to access the context content. In addition, the framework also packages bits of reusable logic as hooks, to facilitate the customization of the UI of existing components without having to rewrite everything. Finally, hooks hide the implementation details of the framework, so that you can focus on the business logic.</p>

<p>So hooks are the primary way to read and change a react-admin application state. We use them in almost every react-admin component, and it’s perfectly normal to use react-admin hooks in your own components.</p>

<p>For instance, the <code class="language-plaintext highlighter-rouge">useRefresh</code> hook packages the logic to force a redraw of the main page content, and to refetch the dataProvider for all the displayed components. Developers don’t need to know how it works, just how to use it:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">useRefresh</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-admin</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">MyRefreshButton</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">refresh</span> <span class="o">=</span> <span class="nx">useRefresh</span><span class="p">();</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">Button</span> <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">refresh</span><span class="si">}</span><span class="p">&gt;</span>Refresh<span class="p">&lt;/</span><span class="nc">Button</span><span class="p">&gt;</span>
    <span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="redux-as-an-implementation-detail">Redux As An Implementation Detail</h2>

<p>React-admin uses <a href="https://react-redux.js.org/">Redux</a> for some of its state management. Redux has performance advantages over pure React contexts. But we don’t document the action creators or the Redux state, because we see Redux as an implementation detail. Instead of dispatching actions, react-admin developers use hooks.</p>

<p>Similarly, react-admin supports redux-saga for side effects with Redux. But the sagas registered at startup are only there for backward compatibility reasons, and no new feature use sagas. Instead, we use hooks.</p>

<p>Previous versions of react-admin used to put a greater emphasis on Redux and redux-saga. It’s no longer the case, and we even consider that we could remove Redux completely in the future - if React ever implements Context selectors.</p>

<h2 id="minimal-api-surface">Minimal API Surface</h2>

<p>Before adding a new hook or a new prop to an existing component, we always check if there isn’t a simple way to implement the feature in pure React. If it’s the case, then we don’t add the new prop. We prefer to keep the react-admin API, code, test, and documentation simple. This choice is crucial to keep the maintenance burden low, and the learning curve acceptable.</p>

<p>For instance, the <code class="language-plaintext highlighter-rouge">&lt;Admin&gt;</code> component only accepts one <code class="language-plaintext highlighter-rouge">theme</code> prop. How can you pass two settings, one for the light theme and one for the dark theme? We could turn the <code class="language-plaintext highlighter-rouge">theme</code> prop into a <code class="language-plaintext highlighter-rouge">lightTheme</code> prop and add a <code class="language-plaintext highlighter-rouge">darkTheme</code> prop. This would complicate the usage and documentation for simple use cases. Besides, it’s doable in pure React, without any change in the react-admin core:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">createContext</span><span class="p">,</span> <span class="nx">cloneElement</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">lightTheme</span><span class="p">,</span> <span class="nx">darkTheme</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./themes</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">themes</span> <span class="o">=</span> <span class="p">{</span> <span class="na">light</span><span class="p">:</span> <span class="nx">lightTheme</span><span class="p">,</span> <span class="na">dark</span><span class="p">:</span> <span class="nx">darkTheme</span> <span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">createContext</span><span class="p">([</span><span class="dl">'</span><span class="s1">light</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{}])</span>

<span class="kd">const</span> <span class="nx">ThemeContextProvider</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">children</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">theme</span><span class="p">,</span> <span class="nx">setTheme</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">ThemeContext</span><span class="p">.</span><span class="nc">Provider</span> <span class="na">value</span><span class="p">=</span><span class="si">{</span><span class="p">[</span><span class="nx">theme</span><span class="p">,</span> <span class="nx">setTheme</span><span class="p">]</span><span class="si">}</span><span class="p">&gt;</span>
            <span class="si">{</span><span class="nx">cloneElement</span><span class="p">(</span><span class="nx">children</span><span class="p">,</span> <span class="p">{</span> <span class="na">theme</span><span class="p">:</span> <span class="nx">themes</span><span class="p">[</span><span class="nx">theme</span><span class="p">]</span> <span class="p">})</span><span class="si">}</span>
        <span class="p">&lt;/</span><span class="nc">ThemeContext</span><span class="p">.</span><span class="nc">Provider</span><span class="p">&gt;</span>
    <span class="p">);</span>    
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">theme</span><span class="p">,</span> <span class="nx">setTheme</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">'</span><span class="s1">light</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nc">ThemeContextProvider</span> <span class="na">value</span><span class="p">=</span><span class="s">"light"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">Admin</span> <span class="na">dataProvider</span><span class="p">=</span><span class="si">{</span><span class="nx">dataProvider</span><span class="si">}</span><span class="p">&gt;</span>
                // ...
            <span class="p">&lt;/</span><span class="nc">Admin</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nc">ThemeContextProvider</span><span class="p">&gt;</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>That way, a button can set the theme by calling <code class="language-plaintext highlighter-rouge">const [_, setTheme] = useContext(ThemeContext)</code>.</p>

<p>We consider this snippet simple enough for a React developer, so we decide not to add support for multiple themes in the core.</p>

<p>If you don’t find a particular feature in the react-admin documentation, it probably means it’s doable in pure React.</p>

<h2 id="principle-of-least-documentation">Principle Of Least Documentation</h2>

<p>None reads docs. It’s an unfortunate fact that we have learned to live with.</p>

<p>So when we design a new feature, we try to do it in the most intuitive way for developers. We keep the API minimal (see above). We copy the API of well-known libraries. We throw errors with helpful and explicit messages. We provide TypeScript types and JSDoc to help developers discover the API from within their IDE. We publish live examples with commented code.</p>

<p>When we have to write documentation, it should contain:</p>

<ol>
  <li>images/screencasts</li>
  <li>code samples</li>
  <li>text</li>
</ol>

<p>In that order of importance.</p>

<h2 id="inspecting-children-is-bad">Inspecting Children Is Bad</h2>

<p>Some components use child inspection for some features. For instance, the <code class="language-plaintext highlighter-rouge">&lt;Datagrid&gt;</code> inspects its Field children at runtime to determine the column headers. This has serious drawbacks:</p>

<ul>
  <li>If the child is wrapped inside another component that doesn’t use the same API, the feature breaks</li>
  <li>Developers expect that a component affects its subtree, not its ancestors. This leads to inexplicable bugs.</li>
</ul>

<p>Every time we implemented child inspection, we regretted it afterward. We tend to avoid it at all costs.</p>

<p>One technique used to avoid child inspection is multiple rendering. For instance, the <code class="language-plaintext highlighter-rouge">&lt;Tab&gt;</code> component renders either a tab header or the tab content, depending on a <code class="language-plaintext highlighter-rouge">context</code> prop passed by its ancestor. That way, when <code class="language-plaintext highlighter-rouge">&lt;TabbedShowLayout&gt;</code> needs to render the tab headers, it renders all its children with <code class="language-plaintext highlighter-rouge">context="header"</code>. Then, for the active tab, it renders a clone with <code class="language-plaintext highlighter-rouge">context="content"</code>.</p>

<h2 id="monorepo">Monorepo</h2>

<p>React-admin is a <em>distribution</em> of several packages, each of which handles a specific feature. The packages are all located in the <code class="language-plaintext highlighter-rouge">packages/</code> directory. The most notable packages are:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ra-core</code>: The core react-admin logic, without any UI.</li>
  <li><code class="language-plaintext highlighter-rouge">ra-ui-materialui</code>: The material-ui skin for react-admin.</li>
  <li><code class="language-plaintext highlighter-rouge">ra-data-*</code>: Data providers for various data backends.</li>
  <li><code class="language-plaintext highlighter-rouge">ra-language-*</code>: Interface translations for various languages.</li>
  <li><code class="language-plaintext highlighter-rouge">ra-test</code>: Utilities for testing react-admin apps and components.</li>
  <li><code class="language-plaintext highlighter-rouge">react-admin</code>: the standard distribution of react-admin</li>
</ul>

<p>You can build your own distribution of react-admin by combining different packages.</p>

<h2 id="backward-compatibility-is-more-important-than-new-features">Backward Compatibility Is More Important Than New Features</h2>

<p>None of us like to update the code of our apps just because an underlying library has published a breaking change. React-admin does its best to avoid losing developers’ time.</p>

<p>Some of the components may have a weird API. That’s probably for historical reasons. We prefer to keep the backward compatibility as high as possible - sometimes at the cost of API consistency.</p>

<p>The code of some components may seem convoluted for no apparent reason. It’s probably that the component has to support both the old and the new syntax.</p>

<p>This backward compatibility costs a lot in maintenance, and we try to reduce this cost by a good automated test coverage.</p>

                    </div>
                    <div class="col hide-on-small-only m3 xl3 offset-xl1">
                        <div class="toc"></div>
                    </div>
                </div>
            </div>
        </main>

        <script src="/js/materialize.min.js"></script>
        <script src="/js/prism.js"></script>
        <script>
            function slugify(text) {
                return text
                    .toString()
                    .toLowerCase()
                    .replace(/\s+/g, '-') // Replace spaces with -
                    .replace(/[^\w\-]+/g, '') // Remove all non-word chars
                    .replace(/\-\-+/g, '-') // Replace multiple - with single -
                    .replace(/^-+/, '') // Trim - from start of text
                    .replace(/-+$/, ''); // Trim - from end of text
            }
            document.addEventListener('DOMContentLoaded', function () {
                M.Sidenav.init(document.querySelectorAll('.sidenav'));
                // Initialize version selector
                M.Dropdown.init(document.querySelectorAll('.dropdown-trigger'));
                /* Generate table of contents */
                tocbot.init({
                    // Where to render the table of contents
                    tocSelector: '.toc',
                    positionFixedSelector: '.toc',
                    // Where to grab the headings to build the table of contents
                    contentSelector: '.toc-content',
                    // More options
                    headingSelector: 'h2, h3, h4',
                    includeHtml: true,
                    collapseDepth: 2,
                    hasInnerContainers: true,
                });
            });
        </script>
        <script
            type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/@docsearch/js@1.0.0-alpha.28"
        ></script>
        <script type="text/javascript">
            docsearch({
                apiKey: '32f254b1de6a25a96665d1229b6eb8f7',
                indexName: 'marmelab-react-admin',
                container: '#docsearch',
            });
        </script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.js"
            defer
        ></script>
        <!--
        React-admin protects your privacy!
        We use our own self-hosted tracking solution to collect some raw metrics,
        like page views, device type (mobile, desktop, etc.) or country.
        We don't track any personal information about our visitors.
    -->
        <script
            async
            defer
            data-website-id="ef7f8242-2808-4cbf-9dff-564daa515bbd"
            src="https://analytics.marmelab.com/umami.js"
        ></script>
    </body>
</html>
